<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Interactive HTML Creator</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #canvas {
            width: 100%;
            height: 100%;
            background-color: #f4f4f4;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .element {
            position: absolute;
            padding: 10px;
            background-color: lightblue;
            border: 2px solid #ccc;
            cursor: move;
            user-select: none;
            box-sizing: border-box;
            text-align: center;
        }
        .bar {
            padding: 5px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .element img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        #options {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border: 1px solid #ccc;
            z-index: 10;
            display: none;
        }
        .input-field {
            margin: 5px 0;
        }
        #doneBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div id="canvas"></div>

<div id="options">
    <button onclick="addElement('header')">Add Header</button>
    <button onclick="addElement('logo')">Add Logo</button>
    <button onclick="addElement('text')">Add Text</button>
    <button onclick="addElement('button')">Add Button</button>
    <button onclick="addSection()">Add Section</button>
</div>

<button id="doneBtn">Done</button>

<script>
    let selectedElement = null;
    const canvas = document.getElementById('canvas');
    const options = document.getElementById('options');

    canvas.addEventListener('click', (e) => {
        options.style.left = `${e.clientX + 20}px`;
        options.style.top = `${e.clientY + 20}px`;
        options.style.display = 'block';
    });

    window.addEventListener('click', (e) => {
        if (!options.contains(e.target) && e.target !== canvas) {
            options.style.display = 'none';
        }
    });

    function convertDriveLink(link) {
        const match = link.match(/\/d\/(.*?)\//);
        return match ? `https://drive.google.com/uc?id=${match[1]}` : link;
    }

    function addElement(type) {
        const element = document.createElement('div');
        element.classList.add('element');
        element.contentEditable = type !== 'logo' && type !== 'button';

        switch (type) {
            case 'header':
                element.innerHTML = "<h2>Click to edit header</h2>";
                break;
            case 'logo':
                const logoURL = prompt("Enter Google Drive link for the logo:");
                const directURL = convertDriveLink(logoURL);
                element.innerHTML = `<img src="${directURL}" alt="Logo" />`;
                element.style.width = '150px';
                element.style.height = '150px';
                break;
            case 'text':
                element.innerHTML = "Click to edit text";
                break;
            case 'button':
                const buttonText = prompt("Enter button text:", "Click Me");
                element.innerHTML = `<button>${buttonText}</button>`;
                break;
        }

        element.style.left = '50%';
        element.style.top = '50%';
        element.style.transform = 'translate(-50%, -50%)';

        addDragFunctionality(element);
        createElementOptionsPanel(element);

        canvas.appendChild(element);
        options.style.display = 'none';
    }

    function addDragFunctionality(element) {
        let offsetX, offsetY;

        element.addEventListener('mousedown', (e) => {
            selectedElement = element;
            offsetX = e.clientX - element.offsetLeft;
            offsetY = e.clientY - element.offsetTop;

            const moveElement = (moveEvent) => {
                selectedElement.style.left = `${moveEvent.clientX - offsetX}px`;
                selectedElement.style.top = `${moveEvent.clientY - offsetY}px`;
            };

            const stopMove = () => {
                document.removeEventListener('mousemove', moveElement);
                document.removeEventListener('mouseup', stopMove);
                selectedElement = null;
            };

            document.addEventListener('mousemove', moveElement);
            document.addEventListener('mouseup', stopMove);
        });
    }

    function createElementOptionsPanel(element) {
        const panel = document.createElement('div');
        panel.classList.add('element-options');
        panel.style.position = 'absolute';
        panel.style.left = `${element.offsetLeft + 20}px`;
        panel.style.top = `${element.offsetTop + 20}px`;

        const widthField = createInputField('Width', 'number', element.offsetWidth, (e) => {
            element.style.width = `${e.target.value}px`;
        });

        const heightField = createInputField('Height', 'number', element.offsetHeight, (e) => {
            element.style.height = `${e.target.value}px`;
        });

        const bgField = createInputField('Bar Background', 'color', '#ADD8E6', (e) => {
            element.style.backgroundColor = e.target.value;
        });

        const fontSizeField = createInputField('Font Size', 'number', '', (e) => {
            element.style.fontSize = `${e.target.value}px`;
        });

        panel.append(widthField, heightField, bgField, fontSizeField);
        document.body.appendChild(panel);
    }

    function createInputField(label, type, value, callback) {
        const input = document.createElement('input');
        input.classList.add('input-field');
        input.type = type;
        input.placeholder = label;
        input.value = value;
        input.addEventListener('input', callback);
        return input;
    }

    document.getElementById('doneBtn').addEventListener('click', () => {
        let htmlContent = '';
        const elements = document.querySelectorAll('.element');

        elements.forEach(element => {
            htmlContent += `<div style="position: absolute; left: ${element.offsetLeft}px; top: ${element.offsetTop}px; background-color: ${element.style.backgroundColor};">${element.innerHTML}</div>\n`;
        });

        const htmlCode = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Custom Design</title></head><body>${htmlContent}</body></html>`;
        prompt("Copy your HTML code:", htmlCode);
    });
</script>

</body>
</html>